# Migration `20200428102104-add-product-table`

This migration has been generated by Tom Barton at 4/28/2020, 10:21:04 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Product" (
    "id" integer  NOT NULL ,
    "name" text  NOT NULL ,
    "price" Decimal(65,30)  NOT NULL ,
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."CartItem" DROP COLUMN "name",
ADD COLUMN "productId" integer  NOT NULL ;

ALTER TABLE "public"."CartItem" ADD FOREIGN KEY ("productId")REFERENCES "public"."Product"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200427211119-add-cart-item-array-to-user..20200428102104-add-product-table
--- datamodel.dml
+++ datamodel.dml
@@ -3,33 +3,40 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("POSTGRESQL_URL")
 }
 model User {
-  email               String   @unique
-  firstname           String
-  id                  Int      @default(autoincrement()) @id
-  lastname            String
-  password            String
-  registeredAt        DateTime @default(now())
-  resetToken          String?  @unique
-  resetTokenExpiry    DateTime?
-  updatedAt           DateTime @updatedAt
-  role                Role
-  cart                CartItem[]
+  email            String     @unique
+  firstname        String
+  id               Int        @default(autoincrement()) @id
+  lastname         String
+  password         String
+  registeredAt     DateTime   @default(now())
+  resetToken       String?    @unique
+  resetTokenExpiry DateTime?
+  updatedAt        DateTime   @updatedAt
+  role             Role
+  cart             CartItem[]
 }
 enum Role {
   ADMIN
   USER
 }
+model Product {
+  id    Int    @id
+  name  String
+  price Float
+}
+
 model CartItem {
-  id Int @id @default(autoincrement())
-  name String
-  quantity Int @default(value: 1)
-  user User @relation(fields: [userId], references: [id])
-  userId Int
+  id        Int     @default(autoincrement()) @id
+  product   Product @relation(fields: [productId], references: [id])
+  productId Int
+  quantity  Int     @default(1)
+  user      User    @relation(fields: [userId], references: [id])
+  userId    Int
 }
```


