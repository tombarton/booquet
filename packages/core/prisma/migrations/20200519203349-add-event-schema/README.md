# Migration `20200519203349-add-event-schema`

This migration has been generated by Tom Barton at 5/19/2020, 8:33:49 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "ContactPreference" AS ENUM ('EMAIL', 'TELEPHONE');

CREATE TABLE "public"."EventParticipant" (
"contactPreference" "ContactPreference" NOT NULL ,"emailAddress" text   ,"eventId" text   ,"id" text  NOT NULL ,"metadata" text  NOT NULL ,"name" text  NOT NULL ,"telephone" text   ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Event" (
"capacity" integer  NOT NULL ,"date" timestamp(3)  NOT NULL ,"id" text  NOT NULL ,"title" text  NOT NULL ,
    PRIMARY KEY ("id"))

ALTER TABLE "public"."EventParticipant" ADD FOREIGN KEY ("eventId")REFERENCES "public"."Event"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200515124724-initial-model..20200519203349-add-event-schema
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("PRISMA_DB_URL")
 }
 model User {
   email            String    @unique
@@ -85,4 +85,28 @@
   updatedAt DateTime    @updatedAt
   user      User?       @relation(fields: [userId], references: [id])
   userId    String?
 }
+
+enum ContactPreference {
+  EMAIL
+  TELEPHONE
+}
+
+model EventParticipant {
+  id                String            @default(uuid()) @id
+  name              String
+  emailAddress      String?
+  telephone         String?
+  contactPreference ContactPreference
+  metadata          String
+  Event             Event?            @relation(fields: [eventId], references: [id])
+  eventId           String?
+}
+
+model Event {
+  id           String             @default(uuid()) @id
+  title        String
+  date         DateTime
+  capacity     Int
+  participants EventParticipant[]
+}
```


